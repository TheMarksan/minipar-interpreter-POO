# üêç Deploy no PythonAnywhere - Guia Completo

## üìã Sobre PythonAnywhere

- ‚úÖ **100% Gr√°tis** (plano b√°sico)
- ‚úÖ Muito f√°cil de configurar
- ‚úÖ N√£o precisa cart√£o de cr√©dito
- ‚ö†Ô∏è WebSocket s√≥ em plano pago ($5/m√™s)
- ‚úÖ Perfeito para projetos acad√™micos

## üöÄ Deploy em 10 Minutos

### Passo 1: Preparar Arquivo Local

No seu computador:

```bash
cd /home/marco/ufal/minipar-interpreter-POO
./prepare_pythonanywhere.sh
```

Isso cria `minipar-pythonanywhere.tar.gz` (~124 KB)

### Passo 2: Criar Conta PythonAnywhere

1. Acesse: https://www.pythonanywhere.com
2. Clique em **Pricing & signup**
3. Escolha **Create a Beginner account** (gr√°tis)
4. Preencha:
   - Username (ex: `minipar2025`)
   - Email
   - Password
5. Confirme email

### Passo 3: Upload do Arquivo

1. No dashboard, clique em **Files**
2. Clique no bot√£o **Upload a file**
3. Selecione `minipar-pythonanywhere.tar.gz`
4. Aguarde upload (30 segundos)

### Passo 4: Descompactar e Instalar

1. No dashboard, clique em **Consoles**
2. Clique em **Bash** (abre novo console)
3. No console bash, execute:

```bash
# Criar diret√≥rio e descompactar
mkdir -p minipar-interpreter
tar -xzf minipar-pythonanywhere.tar.gz -C minipar-interpreter
cd minipar-interpreter

# Criar ambiente virtual com Python 3.10 (importante!)
python3.10 -m venv venv
source venv/bin/activate

# Verificar vers√£o (deve mostrar 3.10)
python --version

# Instalar depend√™ncias
pip install --upgrade pip
pip install -r requirements.txt
```

Aguarde instala√ß√£o (~2 minutos)

### Passo 5: Criar Web App

1. Volte ao dashboard
2. Clique na aba **Web**
3. Clique em **Add a new web app**
4. Clique **Next** (aceita dom√≠nio gratuito)
5. Escolha **Manual configuration** (N√ÉO escolha framework)
6. Python version: **3.10**
7. Clique **Next**

### Passo 6: Configurar Web App

Na p√°gina de configura√ß√£o da Web App:

#### 6.1 - Virtualenv

‚ö†Ô∏è **IMPORTANTE**: O venv criado pode ter Python 3.13, mas o web app precisa de 3.10.

**Solu√ß√£o**: Recriar o virtualenv com Python 3.10:

No Bash console:
```bash
cd ~/minipar-interpreter
rm -rf venv
python3.10 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

Depois, na p√°gina de configura√ß√£o da Web App:

Se√ß√£o **Virtualenv**:
1. Clique em **Enter path to a virtualenv**
2. Digite: `/home/SEU_USERNAME/minipar-interpreter/venv`
3. Clique no ‚úì (checkmark)
4. Verifique que aparece: **Python version: 3.10**

#### 6.2 - WSGI Configuration File

Se√ß√£o **Code**:
1. Clique no link do arquivo WSGI (ex: `/var/www/minipar2025_pythonanywhere_com_wsgi.py`)
2. **DELETE TODO O CONTE√öDO** do arquivo
3. Abra o arquivo `pythonanywhere_wsgi.py` no seu computador
4. **Copie todo o conte√∫do**
5. **Cole** no editor do PythonAnywhere
6. **IMPORTANTE**: Na linha 12, mude:
   ```python
   USERNAME = 'seu_username'  # ‚ö†Ô∏è MUDE AQUI!
   ```
   Para:
   ```python
   USERNAME = 'minipar2025'  # Seu username real
   ```
7. Clique em **Save** (canto superior direito)

#### 6.3 - Static Files (Opcional mas recomendado)

Se√ß√£o **Static files**:

Clique em **Enter URL** e **Enter path**:

| URL | Directory |
|-----|-----------|
| `/static/` | `/home/SEU_USERNAME/minipar-interpreter/frontend` |

### Passo 7: Reload & Testar

1. Volte para a aba **Web**
2. No topo, clique no bot√£o verde **Reload SEU_USERNAME.pythonanywhere.com**
3. Aguarde reload (~10 segundos)
4. Clique no link: `http://seu_username.pythonanywhere.com`

### Passo 8: Testar Funcionalidade

No seu navegador:
```
http://seu_username.pythonanywhere.com
```

Teste:
1. ‚úÖ P√°gina carrega
2. ‚úÖ Selecionar exemplo "Hello World"
3. ‚úÖ Clicar "Executar"
4. ‚úÖ Ver resultado em "Sa√≠da: EXECU√á√ÉO"

## üîß Troubleshooting

### ‚ö†Ô∏è Erro: "Wrong Python version (3.13 instead of 3.10)"

**Causa**: O virtualenv foi criado com Python 3.13 (padr√£o), mas o web app est√° configurado para 3.10

**Solu√ß√£o R√°pida**:
```bash
# No Bash console
cd ~/minipar-interpreter
rm -rf venv
python3.10 -m venv venv
source venv/bin/activate
python --version  # Deve mostrar: Python 3.10.x
pip install --upgrade pip
pip install -r requirements.txt
```

Depois: Web ‚Üí **Reload**

**Alternativa**: Mudar web app para Python 3.13
1. Web ‚Üí Python version: 3.13
2. Recriar venv com `python3.13 -m venv venv`
3. Reinstalar depend√™ncias
4. Reload

### Erro 404 - Page Not Found

**Causa**: WSGI n√£o configurado corretamente

**Solu√ß√£o**:
1. Web ‚Üí WSGI configuration file
2. Verificar que USERNAME est√° correto
3. Save e Reload

### Erro 502 - Bad Gateway

**Causa**: Erro no c√≥digo WSGI ou depend√™ncias faltando

**Solu√ß√£o**:
1. Web ‚Üí Error log (ler √∫ltimas linhas)
2. Verificar virtualenv path
3. Reinstalar depend√™ncias:
```bash
cd ~/minipar-interpreter
source venv/bin/activate
pip install -r requirements.txt
```

### Erro "Module not found"

**Causa**: Depend√™ncia n√£o instalada

**Solu√ß√£o**:
```bash
cd ~/minipar-interpreter
source venv/bin/activate
pip install [nome-do-modulo]
```

### P√°gina em branco

**Causa**: Frontend n√£o est√° sendo servido

**Solu√ß√£o**:
1. Verificar Static files configurado
2. Ou editar WSGI para servir frontend corretamente
3. Reload

### C√≥digo n√£o executa

**Causa**: API /interpretar n√£o est√° funcionando

**Solu√ß√£o**:
1. Abrir console do navegador (F12)
2. Ver erro JavaScript
3. Verificar que URL da API est√° correta
4. Web ‚Üí Error log

## üìä Logs

### Ver Erro Log

1. Web ‚Üí Error log
2. Ver √∫ltimas 100 linhas

### Ver Server Log

1. Web ‚Üí Server log
2. Mostra requisi√ß√µes HTTP

### Ver Access Log

1. Web ‚Üí Access log
2. Mostra acessos ao site

## üîÑ Atualizar C√≥digo

### M√©todo 1: Upload Completo (Recomendado)

Quando fizer mudan√ßas no c√≥digo:

**1. No seu computador local:**
```bash
cd /home/marco/ufal/minipar-interpreter-POO

# Gerar novo arquivo com as mudan√ßas
./prepare_pythonanywhere.sh

# Isso cria minipar-pythonanywhere.tar.gz atualizado
```

**2. No PythonAnywhere:**

a) **Upload do novo arquivo:**
   - Dashboard ‚Üí **Files**
   - Clique em **Upload a file**
   - Selecione o novo `minipar-pythonanywhere.tar.gz`
   - Confirme substitui√ß√£o

b) **No Bash console:**
```bash
# Backup da vers√£o antiga (opcional)
mv minipar-interpreter minipar-interpreter.backup

# Criar novo diret√≥rio e descompactar
mkdir -p minipar-interpreter
tar -xzf minipar-pythonanywhere.tar.gz -C minipar-interpreter
cd minipar-interpreter

# Recriar ambiente virtual (se houve mudan√ßas em requirements.txt)
python3.10 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

c) **Reload:**
   - Web ‚Üí Bot√£o verde **"Reload seu_username.pythonanywhere.com"**

**3. Testar:**
   - Acessar `http://seu_username.pythonanywhere.com`
   - Verificar se mudan√ßas aparecem

### M√©todo 2: Atualizar Arquivos Espec√≠ficos (R√°pido)

Para mudan√ßas pequenas em arquivos individuais:

**1. Editar arquivo diretamente no PythonAnywhere:**
   - Files ‚Üí Browse files
   - Navegar at√© o arquivo (ex: `minipar-interpreter/frontend/home.js`)
   - Clicar no arquivo para editar
   - Fazer mudan√ßas
   - Save

**2. Ou usar Bash console:**
```bash
cd ~/minipar-interpreter

# Exemplo: atualizar arquivo CSS
nano frontend/home.css
# Editar ‚Üí CTRL+O (salvar) ‚Üí CTRL+X (sair)

# Exemplo: atualizar arquivo Python
nano src/lexer/Lexer.py
```

**3. Reload:**
   - Web ‚Üí **Reload**

### M√©todo 3: Git (Avan√ßado)

Se seu c√≥digo est√° no GitHub/GitLab:

**Setup inicial (uma vez):**
```bash
cd ~
git clone https://github.com/TheMarksan/minipar-interpreter-POO.git minipar-interpreter
cd minipar-interpreter
python3.10 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

**Para atualizar:**
```bash
cd ~/minipar-interpreter
git pull origin main

# Se requirements.txt mudou:
source venv/bin/activate
pip install -r requirements.txt

# Web ‚Üí Reload
```

### M√©todo 4: Atualizar apenas Frontend

Se mudou apenas HTML/CSS/JS:

```bash
cd ~/minipar-interpreter/frontend

# Fazer upload dos arquivos espec√≠ficos via Files
# Ou editar diretamente no editor do PythonAnywhere
```

**N√£o precisa reload** se for apenas arquivos est√°ticos!
Apenas limpe cache do navegador: **CTRL+SHIFT+R**

### üéØ Quando Usar Cada M√©todo:

| Situa√ß√£o | M√©todo Recomendado |
|----------|-------------------|
| **Mudan√ßas grandes** (m√∫ltiplos arquivos) | M√©todo 1 (Upload completo) |
| **1-2 arquivos pequenos** | M√©todo 2 (Editar direto) |
| **Desenvolvimento cont√≠nuo** | M√©todo 3 (Git) |
| **Apenas CSS/JS/HTML** | M√©todo 4 (Frontend only) |
| **Nova depend√™ncia** | M√©todo 1 + reinstalar venv |

### ‚ö†Ô∏è Cuidados:

1. **Sempre fa√ßa backup** antes de atualizar:
   ```bash
   cp -r minipar-interpreter minipar-interpreter.backup
   ```

2. **Verifique Error log** ap√≥s reload:
   - Web ‚Üí Error log
   - Procurar por erros

3. **Teste imediatamente** ap√≥s atualizar

4. **Cache do navegador**: Limpar com CTRL+SHIFT+R

### üìù Exemplo Pr√°tico Completo:

```bash
# ==== NO SEU COMPUTADOR ====
cd /home/marco/ufal/minipar-interpreter-POO

# Fazer mudan√ßas no c√≥digo
nano src/lexer/Lexer.py

# Gerar novo arquivo
./prepare_pythonanywhere.sh

# ==== NO PYTHONANYWHERE ====
# 1. Upload minipar-pythonanywhere.tar.gz (via Files)

# 2. No Bash console:
cd ~
rm -rf minipar-interpreter
mkdir minipar-interpreter
tar -xzf minipar-pythonanywhere.tar.gz -C minipar-interpreter
cd minipar-interpreter
python3.10 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 3. Web ‚Üí Reload

# 4. Testar: http://seu_username.pythonanywhere.com
```

### üîç Verificar se Atualiza√ß√£o Funcionou:

```bash
# No Bash console
cd ~/minipar-interpreter

# Ver data de modifica√ß√£o dos arquivos
ls -lh frontend/
ls -lh src/

# Ver vers√£o no c√≥digo (se voc√™ adicionar):
grep -r "VERSION" . | head -5
```

### üí° Dica Pro:

Adicione vers√£o no seu c√≥digo para rastrear:

```python
# Em src/main.py ou similar
VERSION = "2025.11.01.1100"
print(f"MiniPar Interpreter v{VERSION}")
```

Ou no frontend:

```javascript
// Em frontend/home.js
console.log('MiniPar v2025.11.01.1100');
```

## ‚öôÔ∏è Configura√ß√µes Avan√ßadas

### Aumentar Timeout

Arquivo WSGI, adicionar no in√≠cio:
```python
import signal
signal.alarm(300)  # 5 minutos timeout
```

### Habilitar Debug

No WSGI, antes de `application`:
```python
DEBUG = True

def application(environ, start_response):
    if DEBUG:
        import traceback
        try:
            # ... c√≥digo existente ...
        except Exception as e:
            error = traceback.format_exc()
            # Retornar erro detalhado
```

### Custom Domain

**Plano pago necess√°rio**

1. Web ‚Üí Add custom domain
2. Configure CNAME no seu DNS:
```
CNAME minipar -> seu_username.pythonanywhere.com
```

## üí∞ Limita√ß√µes Plano Gratuito

- ‚úÖ 1 web app
- ‚úÖ 512 MB espa√ßo
- ‚úÖ 100.000 requisi√ß√µes/dia
- ‚úÖ CPU: 100 segundos/dia
- ‚ö†Ô∏è Site "dorme" ap√≥s inatividade (acorda ao acessar)
- ‚ùå Sem WebSocket
- ‚ùå Sem HTTPS customizado
- ‚ùå Sem custom domains

### Upgrade para Paid ($5/m√™s)

Se precisar de mais:
- ‚úÖ WebSocket support
- ‚úÖ 10 web apps
- ‚úÖ 1 GB espa√ßo
- ‚úÖ CPU ilimitado
- ‚úÖ Always-on (n√£o dorme)
- ‚úÖ HTTPS customizado

## üìà Monitoramento

### CPU Usage

Dashboard ‚Üí mostra uso di√°rio

### Disk Usage

Files ‚Üí mostra espa√ßo usado

### Database

MySQL gratuito (se precisar)

## üîê Seguran√ßa

### Vari√°veis de Ambiente

Bash console:
```bash
echo 'export SECRET_KEY="valor"' >> ~/.bashrc
source ~/.bashrc
```

No WSGI:
```python
import os
secret = os.environ.get('SECRET_KEY')
```

### Rate Limiting

Adicionar no WSGI:
```python
# TODO: Implementar rate limiting
# Rastrear IPs e limitar requisi√ß√µes
```

## üìö Recursos

- üìñ [Documenta√ß√£o PythonAnywhere](https://help.pythonanywhere.com)
- üí¨ [F√≥rum PythonAnywhere](https://www.pythonanywhere.com/forums/)
- üìß [Suporte Email](mailto:support@pythonanywhere.com)

## ‚úÖ Checklist

Antes de marcar como conclu√≠do:

- [ ] Conta PythonAnywhere criada
- [ ] Arquivo tar.gz preparado
- [ ] Upload feito
- [ ] Descompactado no servidor
- [x] Virtualenv criado e ativado
- [x] Depend√™ncias instaladas
- [x] Web app criada
- [x] Virtualenv path configurado
- [x] WSGI configurado (USERNAME correto!)
- [x] Static files configurados
- [x] Reload executado
- [ ] Site acess√≠vel
- [ ] Teste "Hello World" funciona
- [ ] API /interpretar funciona
- [ ] Logs sem erros

## üéØ URL Final

Seu site estar√° em:
```
http://seu_username.pythonanywhere.com
```

## üí° Dicas

1. **Username**: Escolha algo curto e profissional
2. **Backup**: Mantenha c√≥digo no Git
3. **Logs**: Sempre verifique logs ao debugar
4. **Reload**: Sempre reload ap√≥s mudan√ßas
5. **CPU Limit**: Otimize c√≥digo para n√£o exceder limite di√°rio

## üÜò Suporte

Se precisar de ajuda:

1. Consulte Error log
2. Pesquise no f√≥rum
3. Leia documenta√ß√£o oficial
4. Contate suporte (resposta em 24h)

---

**Pronto!** Seu MiniPar Interpreter est√° online gratuitamente! üéâ
